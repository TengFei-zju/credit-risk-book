# 附录：常用工具与资源

## A.1 技术工具栈

### A.1.1 建模相关

| 工具 | 用途 | 备注 |
|------|------|------|
| `optbinning` | WOE最优分箱 | 评分卡建模必备 |
| `scorecardpy` | 评分卡全流程 | 国内常用 |
| `lightgbm` | 梯度提升树 | 风控ML建模首选 |
| `xgboost` | 梯度提升树 | LightGBM备选 |
| `shap` | 模型解释 | SHAP值计算 |
| `imbalanced-learn` | 不平衡样本处理 | SMOTE等 |
| `optuna` | 超参数搜索 | 替代GridSearch |
| `sklearn` | 通用ML框架 | 评估、预处理等 |
| `statsmodels` | 统计建模 | LR系数显著性检验 |

### A.1.2 数据处理

| 工具 | 用途 |
|------|------|
| `pandas` | 数据处理核心 |
| `polars` | 高性能数据处理（替代pandas） |
| `numpy` | 数值计算 |
| `pyarrow` | 大规模数据IO |
| `pyspark` | 分布式数据处理 |

### A.1.3 图谱分析

| 工具 | 用途 |
|------|------|
| `networkx` | 图分析（中小规模） |
| `torch-geometric` | 图神经网络 |
| `dgl` | 深度图学习框架 |
| `neo4j` | 图数据库（生产环境） |

### A.1.4 工程化

| 工具 | 用途 |
|------|------|
| `mlflow` | 模型版本管理 |
| `fastapi` | 模型服务化 |
| `celery` | 异步任务（批量评分） |
| `redis` | 实时特征缓存 |
| `airflow` | 数据流水线调度 |
| `docker` | 容器化部署 |

---

## A.2 常用评估指标公式速查

### 排序类指标

$$AUC = \frac{1}{n_{pos} \cdot n_{neg}} \sum_{i \in pos} \sum_{j \in neg} \mathbf{1}[score_i > score_j]$$

$$KS = \max_t |F_{bad}(t) - F_{good}(t)|$$

$$GINI = 2 \cdot AUC - 1$$

### 稳定性指标

$$PSI = \sum_i \left( A_i - E_i \right) \cdot \ln\left(\frac{A_i}{E_i}\right)$$

（$A_i$：实际占比，$E_i$：期望占比，各分箱）

### 评分卡转换公式

$$Score = A - B \cdot \ln(Odds)$$

$$B = \frac{PDO}{\ln(2)}, \quad A = BaseScore + B \cdot \ln(BaseOdds)$$

### 信用风险三要素

$$EL = PD \times LGD \times EAD$$

（$EL$：预期损失，$PD$：违约概率，$LGD$：违约损失率，$EAD$：违约风险敞口）

---

## A.3 关键参数参考值

> 以下数值为行业常见参考，不同业务场景差异较大，仅供参考

| 指标 | 参考范围 | 说明 |
|------|---------|------|
| 消费金融坏率（M3+） | 2%~8% | 不同产品、渠道差异大 |
| 申请评分卡KS | 35~50 | 优秀评分卡 |
| 行为评分卡KS | 40~55 | 行为数据更丰富 |
| 反欺诈模型AUC | 0.85~0.95 | 欺诈信号通常更强 |
| 特征IV阈值（入模） | > 0.02 | 低于0.02通常丢弃 |
| PSI告警阈值 | > 0.1 | 关注；> 0.2 触发重建 |
| 分箱最小样本占比 | 5% | 防止分箱过细 |
| WOE编码最小样本量 | 每箱≥100 | 统计稳定性要求 |

---

## A.4 监管参考资料

| 文件 | 发布机构 | 核心内容 |
|------|---------|---------|
| 《征信业管理条例》 | 国务院 | 征信数据使用规范 |
| 《个人信息保护法》 | 全国人大 | 个人数据采集、处理、保存规范 |
| 《商业银行互联网贷款管理暂行办法》 | 银保监会 | 互联网贷款业务规范，核心风控不得外包 |
| 《算法推荐管理规定》 | 网信办 | 算法透明度、可解释性要求 |
| 《金融数据安全分级指南》 | 中国人民银行 | 金融数据分级分类 |
| 巴塞尔协议III | BIS | 国际银行监管框架，含IRB方法（PD/LGD/EAD） |

---

## A.5 学习资源推荐

### 书籍

| 书名 | 推荐理由 |
|------|---------|
| 《信用风险建模》（Thomas等） | 评分卡建模经典教材 |
| 《风险建模》（Siddiqi） | 评分卡实践全面 |
| 《机器学习》（周志华） | ML基础 |
| 《统计学习方法》（李航） | 算法理论基础 |

### 开源项目

- `scorecardpy`：R/Python评分卡工具包
- `optbinning`：Python最优分箱
- `interpret`：微软可解释ML框架
- `alibi`：模型解释工具集

### 行业数据集（练习用）

- **Give Me Some Credit**（Kaggle）：经典信用评分竞赛数据集
- **Home Credit Default Risk**（Kaggle）：更接近真实场景的数据集
- **Lending Club**：美国P2P借贷公开数据

---

## A.6 常见问题排查指南

### 模型离线效果好但线上效果差

```
排查清单：
□ 特征一致性检验（Training-Serving Skew）
□ 时区/时间戳问题
□ 缺失值填充逻辑是否一致
□ 特征版本是否一致（离线用v1，线上用v2）
□ 是否存在数据穿越（Data Leakage）
□ 样本选择偏差（只有通过的客户有标签）
```

### PSI突然升高

```
排查清单：
□ 数据源是否发生变更（字段定义变化、上游系统升级）
□ 渠道/产品结构是否发生变化
□ 是否有新业务策略导致客群突变
□ 是否存在数据管道问题（空值增加、数据延迟）
□ 是否处于特殊时期（节假日、政策变化）
```

### KS持续下降

```
排查清单：
□ 分别查各渠道/产品线的KS，是否局部恶化
□ 查特征重要性是否发生变化
□ 查各特征的PSI，定位漂移特征
□ 查近期是否有策略调整导致客群变化
□ 评估是否需要重训或新增特征
```

---

> **附录说明**：本附录持续更新。工具和资源随时间可能有所变化，请以各官方文档为准。
